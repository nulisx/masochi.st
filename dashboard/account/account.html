<!DOCTYPE html>
<html lang="en">
<head>
    <script src="/assets/t.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 499.8 499.8'%3E%3Cpath fill='%2310b981' d='M477.16,292.045c0,0-62.848-4.221-125.061,22.069c11.664-13.634,23.084-28.804,33.416-45.603c51.428-83.723,56.047-174.385,56.047-174.385s-78.774,45.1-130.221,128.822c-7.563,12.3-13.99,24.738-19.668,37.029c3.467-20.557,5.744-42.617,5.744-65.72C297.417,86.977,249.892,0,249.892,0s-47.506,86.977-47.506,194.259c0,23.102,2.279,45.163,5.742,65.713c-5.68-12.293-12.123-24.723-19.67-37.023C137.017,139.227,58.238,94.127,58.238,94.127s4.623,90.662,56.05,174.385c10.329,16.799,21.75,31.969,33.416,45.603C85.472,287.824,22.64,292.045,22.64,292.045s37.99,47.329,100.418,73.905c23.818,10.137,47.734,15.764,68.231,18.881c-9.681,0.716-19.997,2.132-30.503,4.71c-45.443,11.111-77.006,38.909-77.006,38.909s42.105,9.768,87.561-1.351c29.467-7.217,52.928-21.347,65.893-30.448l-10.852,86.821c-0.506,4.125,0.635,8.272,3.157,11.404c2.522,3.125,6.147,4.923,9.974,4.923h20.791c3.826,0,7.451-1.798,9.975-4.923c2.522-3.132,3.66-7.279,3.156-11.404l-10.852-86.814c12.967,9.103,36.426,23.225,65.875,30.441c45.457,11.118,87.561,1.351,87.561,1.351s-31.564-27.798-77.002-38.909c-10.512-2.578-20.828-3.994-30.508-4.71c20.504-3.117,44.42-8.744,68.238-18.881C439.173,339.374,477.16,292.045,477.16,292.045z'/%3E%3C/svg%3E">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/global.css">
    <link rel="stylesheet" href="/static/css/dashboard/index.css">
    <link rel="stylesheet" href="/static/css/dashboard/account.css">
    <title>Security - Glowi.es</title>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <a href="/" class="sidebar-logo">
                <i class="fas fa-cannabis" style="color: #10b981; margin-right: 8px;"></i>
                Glowi.es
            </a>
        </div>
        <div style="flex: 1;">
            <div style="margin-bottom: 20px;">
                <div style="font-size: 11px; color: rgba(255,255,255,0.4); padding: 0 12px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;">Navigation</div>
                <ul class="sidebar-menu">
                    <a href="/dashboard">
                        <li class="sidebar-menu-item">
                            <i class="fas fa-home"></i>
                            Dashboard
                        </li>
                    </a>
                </ul>
            </div>
            <div style="margin-bottom: 20px;">
                <div style="font-size: 11px; color: rgba(255,255,255,0.4); padding: 0 12px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;">Profile</div>
                <ul class="sidebar-menu">
                    <a href="/integrations">
                        <li class="sidebar-menu-item">
                            <i class="fas fa-plug"></i>
                            Socials
                        </li>
                    </a>
                </ul>
            </div>
            <div>
                <div style="font-size: 11px; color: rgba(255,255,255,0.4); padding: 0 12px; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;">Assets</div>
                <ul class="sidebar-menu">
                    <a href="/collectibles">
                        <li class="sidebar-menu-item">
                            <i class="fas fa-at"></i>
                            Emails
                        </li>
                    </a>
                    <a href="/images">
                        <li class="sidebar-menu-item">
                            <i class="fas fa-images"></i>
                            Images
                        </li>
                    </a>
                </ul>
            </div>
        </div>
        <div class="sidebar-footer">
            <div style="padding: 12px; background: rgba(124, 58, 237, 0.1); border: 1px solid rgba(124, 58, 237, 0.2); border-radius: 8px; margin-bottom: 12px;">
                <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 4px;">Settings</div>
                <a href="/account" style="display: flex; align-items: center; gap: 8px; padding: 8px; background: rgba(124, 58, 237, 0.2); border-radius: 6px; transition: background 0.2s; text-decoration: none; color: white;">
                    <i class="fas fa-cog"></i>
                    <span style="font-size: 13px;">Account</span>
                </a>
                <div style="display: flex; align-items: center; gap: 8px; padding: 8px; border-radius: 6px; transition: background 0.2s; cursor: pointer;">
                    <i class="fas fa-moon"></i>
                    <span style="font-size: 13px;">Privacy</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px; padding: 8px; border-radius: 6px; transition: background 0.2s; cursor: pointer;">
                    <i class="fas fa-life-ring"></i>
                    <span style="font-size: 13px;">Terms of Service</span>
                </div>
            </div>
            <div class="user-profile">
                <img src="/assets/avatar.png" alt="User Avatar" class="user-avatar">
                <div class="user-info">
                    <div class="user-name">Username</div>
                    <div style="font-size: 11px; color: rgba(255,255,255,0.4);">qq@fbi.one</div>
                </div>
                <div style="margin-left: auto;">
                    <i class="fas fa-ellipsis-v" style="color: rgba(255,255,255,0.4); cursor: pointer;"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <div class="content-header">
            <div>
                <h1 class="content-title" style="font-size: 28px; margin-bottom: 4px; display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-shield-alt" style="color: #3b82f6;"></i>
                    Security
                </h1>
                <p class="content-subtitle">Manage your account security, privacy settings, and data protection</p>
            </div>
        </div>

        <div class="account-grid">
            <div class="account-section">
                <div class="section-icon security">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="section-header">
                    <h2 class="section-title">Account Security</h2>
                    <p class="section-description">Protect your account</p>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Two-Factor Authentication</h4>
                        <p>Add an extra layer of security</p>
                    </div>
                    <div class="setting-action">
                        <span class="status-badge disabled">Disabled</span>
                        <button class="action-btn">Enable</button>
                    </div>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Active Sessions</h4>
                        <p>0 active sessions</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn">Manage</button>
                    </div>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Password</h4>
                        <p>Last changed recently</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn">Change</button>
                    </div>
                </div>
            </div>

            <div class="account-section">
                <div class="section-icon privacy">
                    <i class="fas fa-eye"></i>
                </div>
                <div class="section-header">
                    <h2 class="section-title">Privacy Settings</h2>
                    <p class="section-description">Control your visibility</p>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Profile Visibility</h4>
                        <p>Who can see your profile</p>
                    </div>
                    <div class="setting-action">
                        <span class="status-badge public">Public</span>
                        <button class="action-btn">Edit</button>
                    </div>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Profile Themes</h4>
                        <p>Customize appearance</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn">Customize</button>
                    </div>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Avatar & Banner</h4>
                        <p>Manage images</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn">Manage</button>
                    </div>
                </div>
            </div>

            <div class="account-section">
                <div class="section-icon data">
                    <i class="fas fa-database"></i>
                </div>
                <div class="section-header">
                    <h2 class="section-title">Data Protection</h2>
                    <p class="section-description">Manage your data collection preferences and download your information</p>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Data Collection</h4>
                        <p>Analytics and tracking</p>
                    </div>
                    <div class="setting-action">
                        <span class="status-badge protected">Protected</span>
                    </div>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Download Data</h4>
                        <p>Export your information</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn">Download</button>
                    </div>
                </div>
            </div>

            <div class="account-section">
                <div class="section-icon history">
                    <i class="fas fa-history"></i>
                </div>
                <div class="section-header">
                    <h2 class="section-title">Login History</h2>
                    <p class="section-description">View recent login attempts and manage suspicious activity</p>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Recent Activity</h4>
                        <p>Monitor your account access</p>
                    </div>
                    <div class="setting-action">
                        <span class="status-badge uptodate">Up to date</span>
                        <button class="action-btn">View</button>
                    </div>
                </div>
                <div class="login-history-list">
                    <div class="history-item">
                        <div>
                            <div class="history-time">Today at 2:34 PM</div>
                            <div class="history-location">New York, United States • Chrome on Windows</div>
                        </div>
                        <i class="fas fa-check-circle" style="color: #10b981;"></i>
                    </div>
                    <div class="history-item">
                        <div>
                            <div class="history-time">Yesterday at 10:15 AM</div>
                            <div class="history-location">New York, United States • Safari on macOS</div>
                        </div>
                        <i class="fas fa-check-circle" style="color: #10b981;"></i>
                    </div>
                </div>
            </div>

            <div class="account-section">
                <div class="section-icon recovery">
                    <i class="fas fa-key"></i>
                </div>
                <div class="section-header">
                    <h2 class="section-title">Account Recovery</h2>
                    <p class="section-description">Set up recovery methods and backup codes for account access</p>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Recovery Email</h4>
                        <p>Backup email for account recovery</p>
                    </div>
                    <div class="setting-action">
                        <span class="status-badge required">Setup Required</span>
                        <button class="action-btn">Add</button>
                    </div>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Backup Codes</h4>
                        <p>One-time recovery codes</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn">Generate</button>
                    </div>
                </div>
            </div>

            <div class="account-section" style="border-color: rgba(239, 68, 68, 0.3);">
                <div class="section-icon" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(220, 38, 38, 0.15) 100%); color: #ef4444;">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <div class="section-header">
                    <h2 class="section-title" style="color: #ef4444;">Danger Zone</h2>
                    <p class="section-description">Irreversible account actions</p>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Delete Account</h4>
                        <p>Permanently delete your account and all data</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn danger">Delete Account</button>
                    </div>
                </div>
                <div class="setting-row">
                    <div class="setting-info">
                        <h4>Export & Leave</h4>
                        <p>Download your data before leaving</p>
                    </div>
                    <div class="setting-action">
                        <button class="action-btn danger">Export & Delete</button>
                    </div>
                </div>
            </div>
        </div>

        <div style="margin-top: 32px; padding: 20px; background: rgba(59, 130, 246, 0.05); border: 1px solid rgba(59, 130, 246, 0.2); border-radius: 12px;">
            <div style="display: flex; align-items: flex-start; gap: 16px;">
                <i class="fas fa-info-circle" style="color: #3b82f6; font-size: 24px; margin-top: 4px;"></i>
                <div>
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--white); margin-bottom: 8px;">Security Tips</h3>
                    <ul style="font-size: 14px; color: rgba(255,255,255,0.7); line-height: 1.8; padding-left: 20px;">
                        <li>Enable two-factor authentication for enhanced security</li>
                        <li>Use a strong, unique password for your account</li>
                        <li>Regularly review your login history for suspicious activity</li>
                        <li>Keep your recovery email up to date</li>
                        <li>Never share your password or recovery codes with anyone</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function exchange() {
            let t = document.cookie.split("; ").find(t => t.startsWith("auth_token="))?.split("=")[1];
            if (!t) return null;
            try {
                let e = await fetch("https://drugs.rip/api/token/exchange", {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${t}`
                    }
                });
                if (400 === e.status || 401 === e.status) throw Error("Invalid token");
                let a = await e.json();
                return a.success ? a.user : null;
            } catch (n) {
                return null;
            }
        }

        async function fetchProfileData() {
            try {
                const tokenUser = await exchange();
                if (!tokenUser) {
                    console.error('No authenticated user found');
                    return;
                }

                const response = await fetch(`https://drugs.rip/api/${tokenUser.id}`);

                if (!response.ok) {
                    throw new Error('API response was not ok');
                }

                const data = await response.json();

                if (data.success) {
                    updateProfile(data.user);
                } else {
                    console.error('API returned error:', data);
                }
            } catch (error) {
                console.error('Failed to fetch profile data:', error);
            }
        }

        function updateProfile(user) {
            if (user.avatar) {
                const avatarImg = document.querySelector('.user-avatar');
                if (avatarImg) {
                    avatarImg.src = user.avatar;
                }
            }

            if (user.display_name) {
                const userName = document.querySelector('.user-name');
                if (userName) {
                    userName.textContent = user.display_name;
                }
            }
        }

        document.addEventListener('DOMContentLoaded', fetchProfileData);
    </script>
</body>
</html>
