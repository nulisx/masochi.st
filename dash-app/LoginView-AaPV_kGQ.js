import{d as x,q as w,c as a,k as u,f as l,n as z,r as y,a as o,e as k,b as C,w as _,T as $,Q as N,g as d,h as T,v as m,t as f,F as g,j as b,o as i,_ as q}from"./index-CRQdNere.js";const P={class:"bg-[#0f0f0f] antialiased"},V={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-[#0f0f0f]/95 backdrop-blur-sm border-b border-[#1c1c1c] shadow-[0_2px_10px_rgba(0,0,0,0.3)] md:hidden"},D={class:"flex flex-col space-y-4 p-4"},F=["href"],I={class:"pt-4 border-t border-[#1c1c1c] space-y-4"},E={class:"flex flex-col justify-center items-center min-h-screen bg-[#09090b]"},S={class:"w-full max-w-[400px] space-y-6 px-4"},U={class:"space-y-2 text-center"},B={class:"text-2xl font-bold tracking-tight text-white"},A={class:"text-sm text-zinc-400"},j={class:"space-y-6 p-6 bg-zinc-900/30 backdrop-blur-xl rounded-xl border border-zinc-800/50"},L={class:"space-y-4"},M={class:"space-y-2"},K={class:"space-y-2"},O={key:0,class:"text-sm text-red-500"},H={class:"text-center text-sm text-zinc-500"},J={key:1,class:"flex flex-col justify-center items-center min-h-screen bg-[#09090b]"},Q={class:"w-full max-w-[400px] space-y-6 px-4"},W={class:"space-y-6 p-6 bg-zinc-900/30 backdrop-blur-xl rounded-xl border border-zinc-800/50"},G={class:"space-y-6"},R={class:"flex items-center justify-between gap-2"},X=["id","onUpdate:modelValue","onPaste","onInput","onKeydown"],Y={key:0,class:"text-sm text-red-500"},Z={key:2,class:"flex flex-col justify-center items-center min-h-screen bg-[#09090b]"},tt={class:"w-full max-w-[400px] space-y-6 px-4"},et={class:"space-y-2 text-center"},ot={class:"text-xl font-semibold mb-3"},st={class:"text-zinc-400"},at={class:"bg-gradient-to-r from-[#818cf8] to-[#60a5fa] bg-clip-text text-transparent",id:"welcomeU"},it={class:"text-zinc-400"},rt={class:"text-sm text-zinc-400"},nt={class:"space-y-6 p-6 bg-zinc-900/30 backdrop-blur-xl rounded-xl border border-zinc-800/50 shadow-lg animate-fade-in"},lt={class:"text-center text-zinc-400 text-sm"},dt=y("fixed w-full z-50 transition-all duration-200 ease-in-out py-6 bg-transparent border-b border-transparent"),h=y(!1),v=()=>{h.value=!h.value},ct={data(){return{error:"",totpreq:!1,totprequired:!1,welcome:!1,welcomeName:"",form:{username:"",password:"",totpCode:new Array(6).fill("")}}},computed:{notifications(){return this.$store.getters["user/allNotifications"]}},methods:{...w("user",{loginUser:"login"}),removeNotification(r){this.$store.dispatch("user/removeNotification",r)},handleChange(r,e){/^\d?$/.test(e)&&(this.form.totpCode[r]=e,e&&r<5&&this.$nextTick(()=>{const t=document.getElementById(`2fa-${r+1}`);t&&t.focus(),console.log(t)}))},handleKeyDown(r,e){const t=this.$refs.otpInput;r.key==="Backspace"&&!this.form.totpCode[e]&&e>0&&this.$nextTick(()=>{const s=document.getElementById(`2fa-${e-1}`);console.log(t),s&&s.focus()})},handlePaste(r){r.preventDefault();const e=(r.clipboardData||window.clipboardData).getData("text").replace(/\D/g,"").slice(0,this.form.totpCode.length).split("");e.length>0&&(this.form.totpCode=[...e],this.$nextTick(()=>{var s;const t=e.length<this.form.totpCode.length?e.length:this.form.totpCode.length-1;(s=document.getElementById(`2fa-${t}`))==null||s.focus()}))},resetForm(){this.form=JSON.parse(JSON.stringify(this.defaultForm))},async login(){try{const r=this.form.totpCode.join("");this.totprequired&&(r.length===6?this.form.totpCode=r:r.length===0?this.form.totpCode=this.form.totpCode||Array(6).fill(""):this.error="Please enter a 6-digit code.");const e=this.form.username;this.welcomeName=this.form.username;const t=await this.loginUser({username:this.form.username,password:this.form.password,totpCode:r||null});if(t.error)if(t.error==="Two-Factor Authentication is enabled. Please provide the TOTP code."){this.totprequired=!0;return}else{this.$store.dispatch("user/addNotification",{icon:"fas fa-exclamation-circle",title:"Error",message:t.error,type:"error"}),this.totprequired&&(this.form.totpCode=Array(6).fill(""));return}if(t.message){this.$store.dispatch("user/addNotification",{icon:"fas fa-exclamation-circle",title:"Error",message:t.message,type:"error"}),this.resetForm();return}if(this.welcome=!0,!t.accessToken){this.$store.dispatch("user/addNotification",{icon:"fas fa-exclamation-circle",title:"Error",message:"Access token could not be granted",type:"error"});return}this.totprequired=!1;const s=document.getElementById("welcomeU");s&&(s.textContent=e),this.$store.dispatch("user/addNotification",{icon:"fas fa-check-circle",title:"Success",message:"Login successful, please wait.",type:"success"}),setTimeout(()=>{window.location.href="/dash"},2700)}catch(r){this.$store.dispatch("user/addNotification",{icon:"fas fa-exclamation-circle",title:"Error",message:r.message,type:"error"})}}}},pt=x({...ct,__name:"LoginView",setup(r){return(e,t)=>{const s=T("motion");return i(),a("div",P,[e.welcome?u("",!0):(i(),a("nav",{key:0,class:z(dt.value)},[o("div",{class:"max-w-7xl mx-auto px-4 sm:px-6"},[o("div",{class:"flex items-center"},[o("button",{onClick:v,class:"flex md:hidden text-[#e5e5e5] hover:text-white transition-colors mr-4"},[...t[6]||(t[6]=[o("svg",{xmlns:"http:
