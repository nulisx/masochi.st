<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Generate Invite Code</title>
   <link rel="stylesheet" href="/static/css/ic.css">
</head>
<body>
   <div class="container">
      <h2>Generate Invite Code</h2>
      <form id="m-form">
         <input type="m" id="m" placeholder="Enter Password" required>
         <button type="submit">Unlock</button>
      </form>

      <div id="invite-form" style="display: none;">
         <button id="generate-btn">Generate Invite Code</button>
         <p id="invite-code"></p>
      </div>
   </div>

   <script>
      document.addEventListener("contextmenu", function(event){
         event.preventDefault();
      });

      document.addEventListener("keydown", function(event) {
         if (event.key === "F12" || (event.ctrlKey && event.shiftKey && event.key === "I") || (event.ctrlKey && event.key === "U")) {
            event.preventDefault();
         }
      });

      const kk = "aWMzZmlnaHRz";

      function e(k) {
         return atob(k);
      }

      document.getElementById('m-form').addEventListener('submit', function(event) {
         event.preventDefault();
         const m = document.getElementById('m').value;
         if (m === e(kk)) {
            document.getElementById('m-form').style.display = 'none';
            document.getElementById('invite-form').style.display = 'block';
         } else {
            alert('Incorrect Password');
         }
      });

      document.getElementById('generate-btn').addEventListener('click', function() {
         fetch('/generate_invite', { 
            method: 'POST',
            headers: {
               'Content-Type': 'application/json'
            },
            credentials: 'include'
         })
            .then(response => {
               if (!response.ok) {
                  throw new Error('Failed to generate invite code');
               }
               return response.json();
            })
            .then(data => {
               document.getElementById('invite-code').innerText = 'Invite Code: ' + data.code;
            })
            .catch(error => {
               console.error('Error:', error);
               alert('Error: ' + error.message);
            });
      });
   </script>
</body>
</html>
